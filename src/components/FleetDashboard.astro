---
// FleetDashboard.astro - Live Infrastructure Fleet Dashboard
const clusters = [
  {
    name: "CORE-01",
    type: "Bare Metal",
    status: "operational",
    nodes: 5,
    uptime: 99.8,
    workloads: 42,
    lastSync: "2min ago",
  },
  {
    name: "R&D-UNIT",
    type: "Hybrid",
    status: "operational",
    nodes: 3,
    uptime: 98.5,
    workloads: 18,
    lastSync: "5min ago",
  },
];

const metrics = {
  totalPods: 127,
  healthyNodes: "8/8",
  avgCpuUsage: 42,
  avgMemUsage: 68,
  deployments: 24,
  gitOpsSync: "synced",
};
---

<div class="font-mono text-sm">
  <!-- Header -->
  <div
    class="bg-gray-950 border-b border-gray-800 px-4 py-2 flex items-center justify-between"
  >
    <div class="flex items-center gap-2">
      <span class="w-2 h-2 bg-[#00D9A3] rounded-full animate-pulse"></span>
      <span class="text-gray-400 text-xs">FLEET_STATUS</span>
    </div>
    <span class="text-[#00D9A3] text-xs"
      >{new Date().toISOString().split("T")[0]}</span
    >
  </div>

  <!-- Global Metrics -->
  <div class="grid grid-cols-3 gap-2 p-4 bg-gray-950/50">
    <div class="text-center">
      <div class="text-gray-500 text-xs mb-1">PODS</div>
      <div class="text-white text-lg font-bold">{metrics.totalPods}</div>
    </div>
    <div class="text-center">
      <div class="text-gray-500 text-xs mb-1">NODES</div>
      <div class="text-[#00D9A3] text-lg font-bold">{metrics.healthyNodes}</div>
    </div>
    <div class="text-center">
      <div class="text-gray-500 text-xs mb-1">DEPLOYS</div>
      <div class="text-white text-lg font-bold">{metrics.deployments}</div>
    </div>
  </div>

  <!-- Cluster Cards -->
  <div class="p-4 space-y-3">
    {
      clusters.map((cluster) => (
        <div class="bg-gray-900 border border-gray-800 rounded-lg p-3 hover:border-[#00D9A3]/50 transition-colors">
          <div class="flex items-start justify-between mb-3">
            <div>
              <div class="flex items-center gap-2">
                <span class="text-white font-bold text-sm">{cluster.name}</span>
                <span class="px-2 py-0.5 bg-gray-800 text-gray-400 text-xs rounded">
                  {cluster.type}
                </span>
              </div>
              <div class="text-gray-500 text-xs mt-1">
                Last sync: {cluster.lastSync}
              </div>
            </div>
            <div class="flex items-center gap-1">
              <span class="w-1.5 h-1.5 bg-[#00D9A3] rounded-full" />
              <span class="text-[#00D9A3] text-xs uppercase">
                {cluster.status}
              </span>
            </div>
          </div>

          <div class="grid grid-cols-3 gap-3 text-xs">
            <div>
              <div class="text-gray-500 mb-1">Nodes</div>
              <div class="text-white font-semibold">{cluster.nodes}</div>
            </div>
            <div>
              <div class="text-gray-500 mb-1">Uptime</div>
              <div class="text-white font-semibold">{cluster.uptime}%</div>
            </div>
            <div>
              <div class="text-gray-500 mb-1">Workloads</div>
              <div class="text-white font-semibold">{cluster.workloads}</div>
            </div>
          </div>
        </div>
      ))
    }
  </div>

  <!-- Resource Usage Bars -->
  <div class="px-4 pb-4 space-y-3">
    <div>
      <div class="flex justify-between text-xs mb-1">
        <span class="text-gray-500">CPU Utilization</span>
        <span class="text-white">{metrics.avgCpuUsage}%</span>
      </div>
      <div class="w-full bg-gray-900 rounded-full h-2">
        <div
          class="bg-blue-500 h-2 rounded-full"
          style={`width: ${metrics.avgCpuUsage}%`}
        >
        </div>
      </div>
    </div>
    <div>
      <div class="flex justify-between text-xs mb-1">
        <span class="text-gray-500">Memory Utilization</span>
        <span class="text-white">{metrics.avgMemUsage}%</span>
      </div>
      <div class="w-full bg-gray-900 rounded-full h-2">
        <div
          class="bg-[#00D9A3] h-2 rounded-full"
          style={`width: ${metrics.avgMemUsage}%`}
        >
        </div>
      </div>
    </div>
  </div>

  <!-- GitOps Status Footer -->
  <div
    class="bg-gray-950 border-t border-gray-800 px-4 py-2 flex items-center justify-between"
  >
    <div class="flex items-center gap-2">
      <svg
        class="w-4 h-4 text-[#00D9A3]"
        fill="currentColor"
        viewBox="0 0 20 20"
      >
        <path
          fill-rule="evenodd"
          d="M16.707 5.293a1 1 0 010 1.414l-8 8a1 1 0 01-1.414 0l-4-4a1 1 0 011.414-1.414L8 12.586l7.293-7.293a1 1 0 011.414 0z"
          clip-rule="evenodd"></path>
      </svg>
      <span class="text-[#00D9A3] text-xs">GitOps Synchronized</span>
    </div>
    <div class="text-gray-500 text-xs">Auto-reconcile: ON</div>
  </div>
</div>
